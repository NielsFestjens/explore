{"version":3,"sources":["webpack:///webpack/bootstrap 65389da0cc379727e295","webpack:///./ts/shared/Random.ts","webpack:///./ts/webworkers/tileworker/TileWorker.ts","webpack:///./ts/webworkers/tileworker/Commands.ts","webpack:///./ts/webworkers/tileworker/CommandHandlers/index.ts","webpack:///./ts/webworkers/tileworker/commandHandlers/Initialize.ts","webpack:///./ts/shared/Vector2.ts","webpack:///./ts/webworkers/tileworker/Tree.ts","webpack:///./ts/webworkers/tileworker/TileSet.ts","webpack:///./ts/webworkers/tileworker/Events.ts","webpack:///./ts/webworkers/tileworker/TileWorkerContext.ts"],"names":[],"mappings":"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","file":"js/tileworker.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 65389da0cc379727e295","export class Random {\r\n    public seed: number;\r\n    static static: Random = new Random(Math.random());\r\n\r\n    constructor(seed: number) {\r\n        this.seed = seed;\r\n    }\r\n\r\n    next() {\r\n        var x = Math.sin(this.seed++) * 10000;\r\n        return x - Math.floor(x);\r\n    }\r\n\r\n    nextBetween(min: number, max: number) {\r\n        if (min === max)\r\n            return (min);\r\n        \r\n        var next = this.next();\r\n        return ((next * (max - min)) + min);\r\n    };\r\n}\n\n\n// WEBPACK FOOTER //\n// ./ts/shared/Random.ts","import * as Commands from \"webworkers/tileworker/Commands\";\r\nimport * as CommandHandlers from \"webworkers/tileworker/CommandHandlers\";\r\nimport { TileWorkerContext } from 'webworkers/tileworker/TileWorkerContext';\r\nimport { Random } from 'shared/Random';\r\n\r\nexport class TileWorker {\r\n    \r\n    private handlers: { [id: string] : any; } = {};\r\n    private context: TileWorkerContext;\r\n        \r\n    constructor() {\r\n        this.handlers[new Commands.Initialize().name] = CommandHandlers.Initialize;\r\n\r\n        addEventListener('message', this.handleMessage);\r\n\r\n        this.initializeContext();\r\n    }\r\n\r\n    private initializeContext() {\r\n        var random = new Random(500);\r\n        this.context = new TileWorkerContext(this, random);\r\n    }\r\n\r\n    private handleMessage = (message: MessageEvent) => {\r\n        var handler = this.handlers[message.data.name];\r\n        var handlerInstance = new handler();\r\n        handlerInstance.handle(this.context, message.data);\r\n    }\r\n\r\n    public sendMessage(message: any) {\r\n        postMessage(message, undefined);\r\n    }\r\n}\r\n\r\nvar worker = new TileWorker();\n\n\n// WEBPACK FOOTER //\n// ./ts/webworkers/tileworker/TileWorker.ts","import { IWorkerCommand } from 'webworkers/IWorkerCommand';\r\n\r\nexport class Initialize implements IWorkerCommand {\r\n    public name = \"Initialize\";\r\n}\n\n\n// WEBPACK FOOTER //\n// ./ts/webworkers/tileworker/Commands.ts","export { Initialize } from \"webworkers/tileworker/commandHandlers/Initialize\";\n\n\n// WEBPACK FOOTER //\n// ./ts/webworkers/tileworker/CommandHandlers/index.ts","import { Vector2 } from \"shared/Vector2\";\r\n\r\nimport { IWorkerCommand, IWorkerCommandHandler } from 'webworkers/IWorkerCommand';\r\nimport * as Commands from 'webworkers/tileworker/Commands';\r\nimport { TileWorkerContext } from 'webworkers/tileworker/TileWorkerContext';\r\n\r\nimport { Tree } from 'webworkers/tileworker/Tree';\r\nimport { TileSet } from 'webworkers/tileworker/TileSet';\r\nimport { CreatedTree } from \"webworkers/tileworker/Events\";\r\n\r\nexport class Initialize implements IWorkerCommandHandler<TileWorkerContext, Commands.Initialize> {\r\n\r\n    handle(context: TileWorkerContext, command: Commands.Initialize): void {\r\n        context.tileSet = new TileSet(10);\r\n        this.createTrees(context);\r\n        context.tileSet.initialize();\r\n    }\r\n\r\n    createTrees(context: TileWorkerContext) {\r\n        for (let x = -5; x <= 5; x++) {\r\n            for (let z = -5; z <= 5; z++) {\r\n                if (context.random.next() < 0.75) {\r\n                    var tree = new Tree(context);\r\n                    var seed = context.random.next();\r\n                    var age = context.random.next();\r\n                    tree.init(seed, age);\r\n                    context.tileSet.setTile(x, z, tree);\r\n\r\n                    var event = new CreatedTree();\r\n                    event.tileIndex = new Vector2(x, z);\r\n                    event.seed = seed;\r\n                    event.age = age;\r\n                    context.worker.sendMessage(event)\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./ts/webworkers/tileworker/commandHandlers/Initialize.ts","export class Vector2 {\r\n    constructor(\r\n        public x: number,\r\n        public y: number\r\n    ) {\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./ts/shared/Vector2.ts","import { ITileContent, Tile } from \"webworkers/tileworker/TileSet\";\nimport { Random } from \"shared/Random\";\nimport { TileWorkerContext } from 'webworkers/tileworker/TileWorkerContext';\n\nexport class Tree implements ITileContent {\n    public description: string;\n    private tile: Tile;\n    \n    private seed: number;\n    private age: number;\n    private random: Random;\n\n    constructor(\n        private context: TileWorkerContext\n    ) {\n\n    }\n\n    init(seed: number, age: number) {\n        this.seed = seed;\n        this.age = age;\n    }\n\n    public setTile(tile: Tile) {\n        this.tile = tile;\n    }\n\n    public runTick(tickNr: number) {\n        var random = new Random(this.seed + tickNr);\n        if (this.age < 1) {\n            if (random.next() < 0.1) {\n                this.age += .01;\n                if (this.age > 1)\n                    this.age = 1;\n            }\n        }\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./ts/webworkers/tileworker/Tree.ts","import { Vector2 } from \"shared/Vector2\";\r\nimport { CreatedTree } from \"webworkers/tileworker/Events\";\r\nimport { TileWorkerContext } from \"webworkers/tileworker/TileWorkerContext\";\r\n\r\nexport class Tile {\r\n    public content: ITileContent;\r\n    public actions: string[];\r\n\r\n    runTick(tickNr: number) {\r\n        if (this.content)\r\n            this.content.runTick(tickNr);        \r\n    }\r\n}\r\n\r\nexport interface ITileContent {\r\n    description: string;\r\n    setTile(tile: Tile): void;\r\n    runTick(tickNr: number): void;\r\n}\r\n\r\nexport class TileSet {\r\n    public tileSize: number = 10;\r\n    public tiles: Tile[][];\r\n    private tickNr = 0;\r\n\r\n    constructor(\r\n        size: number\r\n    ) {\r\n        this.tiles = [];\r\n        for (let x = -size / 2; x <= size / 2; x++) {\r\n            this.tiles[x] = [];\r\n        }\r\n    }\r\n\r\n    setTile(x: number, z: number, content: ITileContent) {\r\n        var tile = this.tiles[x][z];\r\n        if (!tile)\r\n            tile = this.tiles[x][z] = new Tile();\r\n            \r\n        tile.content = content;\r\n        content.setTile(tile);\r\n    }\r\n\r\n    getTile(index: Vector2) {\r\n        var row = this.tiles[index.x];\r\n        return row ? row[index.y] : undefined;\r\n    }\r\n\r\n    initialize() {\r\n        setInterval(() => this.runTick(), 1000);\r\n    }\r\n\r\n    runTick() {\r\n        this.tickNr++;\r\n        for (var tileRow of this.tiles) {\r\n            for (var tile of tileRow) {\r\n                if (tile)\r\n                    tile.runTick(this.tickNr);\r\n            }\r\n        }\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./ts/webworkers/tileworker/TileSet.ts","import { Vector2 } from \"shared/Vector2\";\r\n\r\nexport class CreatedTree {\r\n    public name = \"CreatedTree\";\r\n    public tileIndex: Vector2;\r\n    public seed: number;\r\n    public age: number;\r\n}\n\n\n// WEBPACK FOOTER //\n// ./ts/webworkers/tileworker/Events.ts","import { Random } from 'shared/Random';\r\nimport { TileSet } from 'webworkers/tileworker/TileSet';\r\nimport { TileWorker } from 'webworkers/tileworker/TileWorker';\r\n\r\nexport class TileWorkerContext {\r\n    public tileSet: TileSet;\r\n\r\n    constructor(\r\n        public worker: TileWorker,\r\n        public random: Random\r\n    ) {\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./ts/webworkers/tileworker/TileWorkerContext.ts"],"sourceRoot":""}